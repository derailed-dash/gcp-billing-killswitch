# TODO

- [x] Create project scaffold, including `README`, `src`, agent folder, `.gitignore`, `.gitattributes`
- [x] Create `TODO.md`
- [x] Create `.env` and point to a Google Cloud project
- [x] Create environment setup script
- [x] Create `Makefile`
- [x] Create `GEMINI.md`
- [x] Create `pyproject.toml`
- [x] Create Cloud Function source code
- [x] Implement SIMULATE_DEACTIVATION flag in Cloud Function source code
- [x] Generate Function `requirements.txt` from `pyproject.toml`, using `make requirements`
- [x] Create and execute unit tests
- [x] Create Cloud Function deployment script
- [x] Create testing strategy
- [x] Create service account
- [x] Fix unit tests
- [x] Create the Pub/Sub with gcloud
- [x] Fix Budget Client 403 with SA
- [x] Implement Integration Testing (Staging Environment)
    - [x] Set up a dedicated test project for integration testing.
    - [x] Deploy the Cloud Function to the integration test project, initially with `SIMULATE_DEACTIVATION=true`.
    - [x] Develop and execute simulated Pub/Sub messages for budget exceeded.
    - [x] Verify function behavior and logging output in simulation mode.
    - [x] Deploy without `SIMULATE_DEACTIVATION` for actual billing deactivation tests on a disposable project.
    - [x] Test with alert below 100%.
- [-] Implement End-to-End Testing (Staging Environment with Real Budget)
    - [x] Configure a real Cloud Billing budget with a low threshold in the staging environment.
    - [x] Deploy the Cloud Function to the staging environment, initially with `SIMULATE_DEACTIVATION=true`.
    - [x] Incur test costs to trigger the budget alert and verify simulation logs.
    - [x] Deploy without `SIMULATE_DEACTIVATION` for actual billing deactivation tests on a disposable project.
    - [x] Add test to handle if billing is already disabled.
    - [x] Verify the entire workflow, from budget alert to billing disablement.
- [ ] Create Terraform deployment